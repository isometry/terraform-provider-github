---
page_title: "github_branch_protection_v3 Resource - github"
subcategory: ""
description: |-
  Protects a GitHub branch using the v3 / REST implementation.  The github_branch_protection resource has moved to the GraphQL API, while this resource will continue to leverage the REST API
---

# github_branch_protection_v3 (Resource)

Protects a GitHub branch.

The `github_branch_protection` resource has moved to the GraphQL API, while this resource will continue to leverage the REST API.

This resource allows you to configure branch protection for repositories in your organization. When applied, the branch will be protected from forced pushes and deletion. Additional constraints, such as required status checks or restrictions on users, teams, and apps, can also be configured.

## Example Usage

```terraform
# Protect the main branch of the foo repository. Only allow a specific user to merge to the branch.
resource "github_branch_protection_v3" "example" {
  repository = github_repository.example.name
  branch     = "main"

  restrictions {
    users = ["foo-user"]
  }
}
```

```terraform
# Protect the main branch of the foo repository. Additionally, require that
# the "ci/check" check ran by the Github Actions app is passing and only allow
# the engineers team merge to the branch.

resource "github_branch_protection_v3" "example" {
  repository     = github_repository.example.name
  branch         = "main"
  enforce_admins = true

  required_status_checks {
    strict = false
    checks = [
      "ci/check:824642007264"
    ]
  }

  required_pull_request_reviews {
    dismiss_stale_reviews = true
    dismissal_users       = ["foo-user"]
    dismissal_teams       = [github_team.example.slug]
    dismissal_app         = ["foo-app"]

    bypass_pull_request_allowances {
      users = ["foo-user"]
      teams = [github_team.example.slug]
      apps  = ["foo-app"]
    }
  }

  restrictions {
    users = ["foo-user"]
    teams = [github_team.example.slug]
    apps  = ["foo-app"]
  }
}

resource "github_repository" "example" {
  name = "example"
}

resource "github_team" "example" {
  name = "Example Name"
}

resource "github_team_repository" "example" {
  team_id    = github_team.example.id
  repository = github_repository.example.name
  permission = "pull"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `branch` (String) The Git branch to protect.
- `repository` (String) The GitHub repository name.

### Optional

- `enforce_admins` (Boolean) Setting this to 'true' enforces status checks for repository administrators.
- `require_conversation_resolution` (Boolean) Setting this to 'true' requires all conversations on code must be resolved before a pull request can be merged.
- `require_signed_commits` (Boolean) Setting this to 'true' requires all commits to be signed with GPG.
- `required_pull_request_reviews` (Block List, Max: 1) Enforce restrictions for pull request reviews. (see [below for nested schema](#nestedblock--required_pull_request_reviews))
- `required_status_checks` (Block List, Max: 1) Enforce restrictions for required status checks. (see [below for nested schema](#nestedblock--required_status_checks))
- `restrictions` (Block List, Max: 1) Enforce restrictions for the users and teams that may push to the branch. (see [below for nested schema](#nestedblock--restrictions))

### Read-Only

- `etag` (String)
- `id` (String) The ID of this resource.

<a id="nestedblock--required_pull_request_reviews"></a>
### Nested Schema for `required_pull_request_reviews`

Optional:

- `bypass_pull_request_allowances` (Block List, Max: 1) (see [below for nested schema](#nestedblock--required_pull_request_reviews--bypass_pull_request_allowances))
- `dismiss_stale_reviews` (Boolean) Dismiss approved reviews automatically when a new commit is pushed.
- `dismissal_apps` (Set of String) The list of apps slugs with dismissal access. Always use slug of the app, not its name. Each app already has to have access to the repository.
- `dismissal_teams` (Set of String) The list of team slugs with dismissal access. Always use slug of the team, not its name. Each team already has to have access to the repository.
- `dismissal_users` (Set of String) The list of user logins with dismissal access.
- `include_admins` (Boolean, Deprecated)
- `require_code_owner_reviews` (Boolean) Require an approved review in pull requests including files with a designated code owner.
- `require_last_push_approval` (Boolean) Require that the most recent push must be approved by someone other than the last pusher.
- `required_approving_review_count` (Number) Require 'x' number of approvals to satisfy branch protection requirements. If this is specified it must be a number between 0-6.

<a id="nestedblock--required_pull_request_reviews--bypass_pull_request_allowances"></a>
### Nested Schema for `required_pull_request_reviews.bypass_pull_request_allowances`

Optional:

- `apps` (Set of String)
- `teams` (Set of String)
- `users` (Set of String)



<a id="nestedblock--required_status_checks"></a>
### Nested Schema for `required_status_checks`

Optional:

- `checks` (Set of String) The list of status checks to require in order to merge into this branch. No status checks are required by default. Checks should be strings containing the 'context' and 'app_id' like so 'context:app_id'
- `contexts` (Set of String, Deprecated)
- `include_admins` (Boolean, Deprecated)
- `strict` (Boolean) Require branches to be up to date before merging.


<a id="nestedblock--restrictions"></a>
### Nested Schema for `restrictions`

Optional:

- `apps` (Set of String) The list of app slugs with push access.
- `teams` (Set of String) The list of team slugs with push access. Always use slug of the team, not its name. Each team already has to have access to the repository.
- `users` (Set of String) The list of user logins with push access.

## Import

GitHub Branch Protection can be imported using an ID made up of `repository:branch`, e.g.

```shell
terraform import github_branch_protection_v3.terraform terraform:main
```
