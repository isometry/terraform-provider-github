---
page_title: "github_branch_protection Resource - github"
subcategory: ""
description: |-
  Protects a GitHub branch.
---

# github_branch_protection (Resource)

Protects a GitHub branch.

This resource allows you to configure branch protection for repositories in your organization. When applied, the branch will be protected from forced pushes and deletion. Additional constraints, such as required status checks or restrictions on users, teams, and apps, can also be configured.

Note: for the `push_allowances` a given user or team must have specific write access to the repository. If specific write access not provided, github will reject the given actor, which will be the cause of terraform drift.

## Example Usage

```terraform
# Protect the main branch of the foo repository. Additionally, require that
# the "ci/travis" context to be passing and only allow the engineers team merge
# to the branch.

resource "github_branch_protection" "example" {
  repository_id = github_repository.example.node_id
  # also accepts repository name
  # repository_id  = github_repository.example.name

  pattern          = "main"
  enforce_admins   = true
  allows_deletions = true

  required_status_checks {
    strict   = false
    contexts = ["ci/travis"]
  }

  required_pull_request_reviews {
    dismiss_stale_reviews = true
    restrict_dismissals   = true
    dismissal_restrictions = [
      data.github_user.example.node_id,
      github_team.example.node_id,
      "/exampleuser",
      "exampleorganization/exampleteam",
    ]
  }

  restrict_pushes {
    push_allowances = [
      data.github_user.example.node_id,
      "/exampleuser",
      "exampleorganization/exampleteam",
      # you can have more than one type of restriction (teams + users). If you use
      # more than one type, you must use node_ids of each user and each team.
      # github_team.example.node_id
      # github_user.example-2.node_id
    ]
  }

  force_push_bypassers = [
    data.github_user.example.node_id,
    "/exampleuser",
    "exampleorganization/exampleteam",
    # you can have more than one type of restriction (teams + users)
    # github_team.example.node_id
    # github_team.example-2.node_id
  ]

}

resource "github_repository" "example" {
  name = "test"
}

data "github_user" "example" {
  username = "example"
}

resource "github_team" "example" {
  name = "Example Name"
}

resource "github_team_repository" "example" {
  team_id    = github_team.example.id
  repository = github_repository.example.name
  permission = "pull"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `pattern` (String) Identifies the protection rule pattern.
- `repository_id` (String) The name or node ID of the repository associated with this branch protection rule.

### Optional

- `allows_deletions` (Boolean) Setting this to 'true' to allow the branch to be deleted.
- `allows_force_pushes` (Boolean) Setting this to 'true' to allow force pushes on the branch.
- `enforce_admins` (Boolean) Setting this to 'true' enforces status checks for repository administrators.
- `force_push_bypassers` (Set of String) The list of actor Names/IDs that are allowed to bypass force push restrictions. Actor names must either begin with a '/' for users or the organization name followed by a '/' for teams.
- `lock_branch` (Boolean) Setting this to 'true' will make the branch read-only and preventing any pushes to it.
- `require_conversation_resolution` (Boolean) Setting this to 'true' requires all conversations on code must be resolved before a pull request can be merged.
- `require_signed_commits` (Boolean) Setting this to 'true' requires all commits to be signed with GPG.
- `required_linear_history` (Boolean) Setting this to 'true' enforces a linear commit Git history, which prevents anyone from pushing merge commits to a branch.
- `required_pull_request_reviews` (Block List) Enforce restrictions for pull request reviews. (see [below for nested schema](#nestedblock--required_pull_request_reviews))
- `required_status_checks` (Block List) Enforce restrictions for required status checks. (see [below for nested schema](#nestedblock--required_status_checks))
- `restrict_pushes` (Block List) Restrict who can push to matching branches. (see [below for nested schema](#nestedblock--restrict_pushes))

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--required_pull_request_reviews"></a>
### Nested Schema for `required_pull_request_reviews`

Optional:

- `dismiss_stale_reviews` (Boolean) Dismiss approved reviews automatically when a new commit is pushed.
- `dismissal_restrictions` (Set of String) The list of actor Names/IDs with dismissal access. If not empty, 'restrict_dismissals' is ignored. Actor names must either begin with a '/' for users or the organization name followed by a '/' for teams.
- `pull_request_bypassers` (Set of String) The list of actor Names/IDs that are allowed to bypass pull request requirements. Actor names must either begin with a '/' for users or the organization name followed by a '/' for teams.
- `require_code_owner_reviews` (Boolean) Require an approved review in pull requests including files with a designated code owner.
- `require_last_push_approval` (Boolean) Require that The most recent push must be approved by someone other than the last pusher.
- `required_approving_review_count` (Number) Require 'x' number of approvals to satisfy branch protection requirements. If this is specified it must be a number between 0-6.
- `restrict_dismissals` (Boolean) Restrict pull request review dismissals.


<a id="nestedblock--required_status_checks"></a>
### Nested Schema for `required_status_checks`

Optional:

- `contexts` (Set of String) The list of status checks to require in order to merge into this branch. No status checks are required by default.
- `strict` (Boolean) Require branches to be up to date before merging.


<a id="nestedblock--restrict_pushes"></a>
### Nested Schema for `restrict_pushes`

Optional:

- `blocks_creations` (Boolean) Restrict pushes that create matching branches.
- `push_allowances` (Set of String) The list of actor Names/IDs that may push to the branch. Actor names must either begin with a '/' for users or the organization name followed by a '/' for teams.

## Import

GitHub Branch Protection can be imported using an ID made up of `repository:pattern`, e.g.

```shell
terraform import github_branch_protection.terraform terraform:main
```
